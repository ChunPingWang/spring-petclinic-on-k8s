spring:
  application:
    name: customers-service
  # Default: HSQLDB in-memory database for local dev
  datasource:
    url: ${SPRING_DATASOURCE_URL:jdbc:hsqldb:mem:testdb}
    username: ${SPRING_DATASOURCE_USERNAME:sa}
    password: ${SPRING_DATASOURCE_PASSWORD:}
  jpa:
    hibernate:
      ddl-auto: ${SPRING_JPA_HIBERNATE_DDL_AUTO:create-drop}

server:
  port: ${SERVER_PORT:8081}

# Actuator endpoints for K8s health checks
management:
  endpoints:
    web:
      exposure:
        include: ${MANAGEMENT_ENDPOINTS_WEB_EXPOSURE_INCLUDE:health,info,prometheus,metrics}
  endpoint:
    health:
      probes:
        enabled: ${MANAGEMENT_ENDPOINT_HEALTH_PROBES_ENABLED:true}
  health:
    livenessState:
      enabled: ${MANAGEMENT_HEALTH_LIVENESSSTATE_ENABLED:true}
    readinessState:
      enabled: ${MANAGEMENT_HEALTH_READINESSSTATE_ENABLED:true}
  zipkin:
    tracing:
      endpoint: ${MANAGEMENT_ZIPKIN_TRACING_ENDPOINT:http://localhost:9411/api/v2/spans}
  tracing:
    sampling:
      probability: ${MANAGEMENT_TRACING_SAMPLING_PROBABILITY:1.0}

---
spring:
  config:
    activate:
      on-profile: docker
  datasource:
    url: jdbc:mysql://mysql:3306/petclinic
    username: root
    password: petclinic
  jpa:
    hibernate:
      ddl-auto: update

management:
  zipkin:
    tracing:
      endpoint: http://tracing-server:9411/api/v2/spans

---
spring:
  config:
    activate:
      on-profile: kubernetes
  datasource:
    url: ${SPRING_DATASOURCE_URL:jdbc:hsqldb:mem:testdb}
    username: ${SPRING_DATASOURCE_USERNAME:sa}
    password: ${SPRING_DATASOURCE_PASSWORD:}
  jpa:
    hibernate:
      ddl-auto: ${SPRING_JPA_HIBERNATE_DDL_AUTO:create-drop}

management:
  zipkin:
    tracing:
      endpoint: ${MANAGEMENT_ZIPKIN_TRACING_ENDPOINT:http://tracing-server:9411/api/v2/spans}
